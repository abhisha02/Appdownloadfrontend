{"ast":null,"code":"import React,{useState,useEffect}from'react';import{X}from'lucide-react';import api from'../../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Modal=_ref=>{let{isOpen,onClose,title,children}=_ref;if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md relative shadow-2xl ring-1 ring-gray-200 dark:ring-gray-700\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"absolute right-4 top-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\",children:/*#__PURE__*/_jsx(X,{size:24})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 dark:text-white mb-4\",children:title}),children]})});};const ClaimModal=_ref2=>{let{isOpen,onClose}=_ref2;const[pendingTasks,setPendingTasks]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[selectedTask,setSelectedTask]=useState(null);const[screenshot,setScreenshot]=useState(null);const[submitting,setSubmitting]=useState(false);useEffect(()=>{const fetchPendingTasks=async()=>{try{const response=await api.get('/apps/available/');setPendingTasks(response.data);setLoading(false);}catch(err){setError('Failed to fetch pending tasks');setLoading(false);}};if(isOpen){fetchPendingTasks();}},[isOpen]);const handleTaskSelect=task=>{setSelectedTask(task);setScreenshot(null);setError(null);};const handleScreenshotChange=e=>{const file=e.target.files[0];if(file){if(file.size>5*1024*1024){setError('Screenshot size should be less than 5MB');return;}setScreenshot(file);setError(null);}};const handleSubmit=async()=>{if(!selectedTask||!screenshot){setError('Please select a task and upload a screenshot');return;}setSubmitting(true);const formData=new FormData();formData.append('app',selectedTask.id);formData.append('screenshot',screenshot);try{await api.post('apps/tasks/submit/',formData,{headers:{'Content-Type':'multipart/form-data'}});setPendingTasks(pendingTasks.filter(task=>task.id!==selectedTask.id));setSelectedTask(null);setScreenshot(null);setError('Task submitted successfully!');setTimeout(()=>setError(null),3000);}catch(err){setError('Failed to submit task. Please try again.');}finally{setSubmitting(false);}};return/*#__PURE__*/_jsx(Modal,{isOpen:isOpen,onClose:onClose,title:\"Select the App and upload screenshot to Claim Your Points\",children:/*#__PURE__*/_jsxs(\"div\",{children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-600 p-3 rounded-lg mb-4\",children:error}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-gray-600 dark:text-gray-400\",children:\"Loading tasks...\"}):pendingTasks.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600 dark:text-gray-400 text-center py-4\",children:\"No pending tasks available.\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:pendingTasks.map(task=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-3 rounded-lg cursor-pointer transition \".concat((selectedTask===null||selectedTask===void 0?void 0:selectedTask.id)===task.id?'bg-blue-50 border-2 border-blue-600':'bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600'),onClick:()=>handleTaskSelect(task),children:[task.app_icon&&/*#__PURE__*/_jsx(\"img\",{src:task.app_icon,alt:task.name,className:\"w-full h-20 object-contain mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-900 dark:text-white text-center text-sm\",children:task.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-600 dark:text-blue-400 text-center text-sm font-medium\",children:[task.points_value,\" Points\"]})]},task.id))}),selectedTask&&/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-900 dark:text-white\",children:[\"Selected: \",selectedTask.name]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 dark:text-gray-300\",children:\"Upload Screenshot\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleScreenshotChange,className:\"w-full text-gray-900 dark:text-white\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,disabled:submitting||!screenshot,className:\"w-full py-2.5 rounded-lg transition \".concat(submitting||!screenshot?'bg-gray-300 cursor-not-allowed text-gray-600':'bg-blue-600 hover:bg-blue-700 text-white'),children:submitting?'Submitting...':'Submit Task'})]})]})]})});};export default ClaimModal;","map":{"version":3,"names":["React","useState","useEffect","X","api","jsx","_jsx","jsxs","_jsxs","Modal","_ref","isOpen","onClose","title","children","className","onClick","size","ClaimModal","_ref2","pendingTasks","setPendingTasks","loading","setLoading","error","setError","selectedTask","setSelectedTask","screenshot","setScreenshot","submitting","setSubmitting","fetchPendingTasks","response","get","data","err","handleTaskSelect","task","handleScreenshotChange","e","file","target","files","handleSubmit","formData","FormData","append","id","post","headers","filter","setTimeout","length","map","concat","app_icon","src","alt","name","points_value","type","accept","onChange","disabled"],"sources":["D:/AndroidAppdownloadportalApp/Andoridappdownloadfrontend/Appdownload/src/components/User/ClaimModal.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { X } from 'lucide-react';\r\nimport api from '../../services/api';\r\n\r\nconst Modal = ({ isOpen, onClose, title, children }) => {\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 w-full max-w-md relative shadow-2xl ring-1 ring-gray-200 dark:ring-gray-700\">\r\n        <button\r\n          onClick={onClose}\r\n          className=\"absolute right-4 top-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\r\n        >\r\n          <X size={24} />\r\n        </button>\r\n        <h2 className=\"text-xl font-bold text-gray-900 dark:text-white mb-4\">{title}</h2>\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst ClaimModal = ({ isOpen, onClose }) => {\r\n    const [pendingTasks, setPendingTasks] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const [selectedTask, setSelectedTask] = useState(null);\r\n    const [screenshot, setScreenshot] = useState(null);\r\n    const [submitting, setSubmitting] = useState(false);\r\n  \r\n    useEffect(() => {\r\n      const fetchPendingTasks = async () => {\r\n        try {\r\n          const response = await api.get('/apps/available/');\r\n          setPendingTasks(response.data);\r\n          setLoading(false);\r\n        } catch (err) {\r\n          setError('Failed to fetch pending tasks');\r\n          setLoading(false);\r\n        }\r\n      };\r\n  \r\n      if (isOpen) {\r\n        fetchPendingTasks();\r\n      }\r\n    }, [isOpen]);\r\n  \r\n    const handleTaskSelect = (task) => {\r\n      setSelectedTask(task);\r\n      setScreenshot(null);\r\n      setError(null);\r\n    };\r\n  \r\n    const handleScreenshotChange = (e) => {\r\n      const file = e.target.files[0];\r\n      if (file) {\r\n        if (file.size > 5 * 1024 * 1024) {\r\n          setError('Screenshot size should be less than 5MB');\r\n          return;\r\n        }\r\n        setScreenshot(file);\r\n        setError(null);\r\n      }\r\n    };\r\n  \r\n    const handleSubmit = async () => {\r\n      if (!selectedTask || !screenshot) {\r\n        setError('Please select a task and upload a screenshot');\r\n        return;\r\n      }\r\n  \r\n      setSubmitting(true);\r\n      const formData = new FormData();\r\n      formData.append('app', selectedTask.id);\r\n      formData.append('screenshot', screenshot);\r\n  \r\n      try {\r\n        await api.post('apps/tasks/submit/', formData, {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n          },\r\n        });\r\n        setPendingTasks(pendingTasks.filter(task => task.id !== selectedTask.id));\r\n        setSelectedTask(null);\r\n        setScreenshot(null);\r\n        setError('Task submitted successfully!');\r\n        setTimeout(() => setError(null), 3000);\r\n      } catch (err) {\r\n        setError('Failed to submit task. Please try again.');\r\n      } finally {\r\n        setSubmitting(false);\r\n      }\r\n    };\r\n  \r\n    return (\r\n      <Modal isOpen={isOpen} onClose={onClose} title=\"Select the App and upload screenshot to Claim Your Points\">\r\n        <div>\r\n          {error && (\r\n            <div className=\"bg-red-50 text-red-600 p-3 rounded-lg mb-4\">\r\n              {error}\r\n            </div>\r\n          )}\r\n  \r\n          {loading ? (\r\n            <div className=\"text-center py-4 text-gray-600 dark:text-gray-400\">Loading tasks...</div>\r\n          ) : pendingTasks.length === 0 ? (\r\n            <div className=\"text-gray-600 dark:text-gray-400 text-center py-4\">\r\n              No pending tasks available.\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                {pendingTasks.map((task) => (\r\n                  <div\r\n                    key={task.id}\r\n                    className={`p-3 rounded-lg cursor-pointer transition ${\r\n                      selectedTask?.id === task.id\r\n                        ? 'bg-blue-50 border-2 border-blue-600'\r\n                        : 'bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600'\r\n                    }`}\r\n                    onClick={() => handleTaskSelect(task)}\r\n                  >\r\n                    {task.app_icon && (\r\n                      <img\r\n                        src={task.app_icon}\r\n                        alt={task.name}\r\n                        className=\"w-full h-20 object-contain mb-2\"\r\n                      />\r\n                    )}\r\n                    <p className=\"text-gray-900 dark:text-white text-center text-sm\">{task.name}</p>\r\n                    <p className=\"text-blue-600 dark:text-blue-400 text-center text-sm font-medium\">\r\n                      {task.points_value} Points\r\n                    </p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n  \r\n              {selectedTask && (\r\n                <div className=\"space-y-3\">\r\n                  <p className=\"text-gray-900 dark:text-white\">Selected: {selectedTask.name}</p>\r\n                  <div className=\"space-y-2\">\r\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Upload Screenshot</label>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      onChange={handleScreenshotChange}\r\n                      className=\"w-full text-gray-900 dark:text-white\"\r\n                    />\r\n                  </div>\r\n  \r\n                  <button\r\n                    onClick={handleSubmit}\r\n                    disabled={submitting || !screenshot}\r\n                    className={`w-full py-2.5 rounded-lg transition ${\r\n                      submitting || !screenshot\r\n                        ? 'bg-gray-300 cursor-not-allowed text-gray-600'\r\n                        : 'bg-blue-600 hover:bg-blue-700 text-white'\r\n                    }`}\r\n                  >\r\n                    {submitting ? 'Submitting...' : 'Submit Task'}\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </Modal>\r\n    );\r\n};\r\n\r\nexport default ClaimModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}